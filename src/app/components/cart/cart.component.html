<div class="card p-4">
    <h2 class="text-3xl font-bold mb-4">Shopping Cart</h2>
    @if (cartItems().length === 0) {
    <div class="text-center p-6 bg-surface-50 border-round">
        <i class="pi pi-shopping-cart text-6xl text-gray-400 mb-3"></i>
        <p class="text-xl text-gray-600 mb-4">Your cart is empty.</p>
        <button pButton label="Start Shopping" routerLink="/products"></button>
    </div>
    } @else {
    <div class="grid">
        <div class="col-12 lg:col-8">
            <p-table [value]="cartItems()" [tableStyle]="{'min-width': '50rem'}">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Product</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th></th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                    <tr>
                        <td>
                            <div class="flex align-items-center gap-3">
                                <img [src]="item.product.image" [alt]="item.product.title" width="60"
                                    class="shadow-2 border-round" />
                                <span class="font-semibold">{{ item.product.title }}</span>
                            </div>
                        </td>
                        <td>${{ item.product.price }}</td>
                        <td>
                            <p-inputNumber [ngModel]="item.quantity"
                                (ngModelChange)="updateQuantity(item.product.id, $event)" [showButtons]="true"
                                buttonLayout="horizontal" inputId="vertical" spinnerMode="horizontal" [min]="1"
                                inputStyleClass="w-3rem text-center" decrementButtonClass="p-button-secondary"
                                incrementButtonClass="p-button-secondary" incrementButtonIcon="pi pi-plus"
                                decrementButtonIcon="pi pi-minus">
                            </p-inputNumber>
                        </td>
                        <td class="font-bold text-primary">${{ (item.product.price * item.quantity).toFixed(2) }}</td>
                        <td>
                            <button pButton icon="pi pi-trash" class="p-button-rounded p-button-danger p-button-text"
                                (click)="removeItem(item.product.id)"></button>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
        <div class="col-12 lg:col-4">
            <div class="surface-card p-4 shadow-2 border-round">
                <h3 class="text-xl font-bold mb-3">Order Summary</h3>
                <div class="flex justify-content-between mb-3">
                    <span>Subtotal</span>
                    <span>${{ cartTotal().toFixed(2) }}</span>
                </div>
                <div class="flex justify-content-between mb-3">
                    <span>Shipping</span>
                    <span>Free</span>
                </div>
                <hr class="mb-3 custom-hr">
                <div class="flex justify-content-between mb-4 text-xl font-bold">
                    <span>Total</span>
                    <span class="text-primary">${{ cartTotal().toFixed(2) }}</span>
                </div>
                <button pButton label="Proceed to Checkout" class="w-full text-lg py-3" (click)="checkout()"></button>
            </div>
        </div>
    </div>
    }
</div>